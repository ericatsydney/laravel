!function e(t,i,n){function o(r,a){if(!i[r]){if(!t[r]){var l="function"==typeof require&&require;if(!a&&l)return l(r,!0);if(s)return s(r,!0);var u=new Error("Cannot find module '"+r+"'");throw u.code="MODULE_NOT_FOUND",u}var d=i[r]={exports:{}};t[r][0].call(d.exports,function(e){var i=t[r][1][e];return o(i?i:e)},d,d.exports,e,t,i,n)}return i[r].exports}for(var s="function"==typeof require&&require,r=0;r<n.length;r++)o(n[r]);return o}({1:[function(e,t,i){(function(i){var n="undefined"!=typeof window?window.L:"undefined"!=typeof i?i.L:null,o=e("./geocoders/nominatim")["class"];t.exports={"class":n.Control.extend({options:{showResultIcons:!1,collapsed:!0,expand:"click",position:"topright",placeholder:"Search...",errorMessage:"Nothing found."},_callbackId:0,initialize:function(e){n.Util.setOptions(this,e),this.options.geocoder||(this.options.geocoder=new o)},onAdd:function(e){var t,i="leaflet-control-geocoder",o=n.DomUtil.create("div",i+" leaflet-bar"),s=n.DomUtil.create("a","leaflet-control-geocoder-icon",o),r=this._form=n.DomUtil.create("form",i+"-form",o);return s.innerHTML="&nbsp;",s.href="javascript:void(0);",this._map=e,this._container=o,t=this._input=n.DomUtil.create("input"),t.type="text",t.placeholder=this.options.placeholder,n.DomEvent.addListener(t,"keydown",this._keydown,this),this._errorElement=document.createElement("div"),this._errorElement.className=i+"-form-no-error",this._errorElement.innerHTML=this.options.errorMessage,this._alts=n.DomUtil.create("ul",i+"-alternatives leaflet-control-geocoder-alternatives-minimized"),r.appendChild(t),this._container.appendChild(this._errorElement),o.appendChild(this._alts),n.DomEvent.addListener(r,"submit",this._geocode,this),this.options.collapsed?"click"===this.options.expand?n.DomEvent.addListener(s,"click",function(e){0===e.button&&2!==e.detail&&this._toggle()},this):(n.DomEvent.addListener(s,"mouseover",this._expand,this),n.DomEvent.addListener(s,"mouseout",this._collapse,this),this._map.on("movestart",this._collapse,this)):(n.DomEvent.addListener(s,"click",function(e){this._geocode(e)},this),this._expand()),n.DomEvent.disableClickPropagation(o),o},_geocodeResult:function(e){if(n.DomUtil.removeClass(this._container,"leaflet-control-geocoder-throbber"),1===e.length)this._geocodeResultSelected(e[0]);else if(e.length>0){this._alts.innerHTML="",this._results=e,n.DomUtil.removeClass(this._alts,"leaflet-control-geocoder-alternatives-minimized");for(var t=0;t<e.length;t++)this._alts.appendChild(this._createAlt(e[t],t))}else n.DomUtil.addClass(this._errorElement,"leaflet-control-geocoder-error")},markGeocode:function(e){return this._map.fitBounds(e.bbox),this._geocodeMarker&&this._map.removeLayer(this._geocodeMarker),this._geocodeMarker=new n.Marker(e.center).bindPopup(e.html||e.name).addTo(this._map).openPopup(),this},_geocode:function(e){return n.DomEvent.preventDefault(e),n.DomUtil.addClass(this._container,"leaflet-control-geocoder-throbber"),this._clearResults(),this.options.geocoder.geocode(this._input.value,this._geocodeResult,this),!1},_geocodeResultSelected:function(e){this.options.collapsed?this._collapse():this._clearResults(),this.markGeocode(e)},_toggle:function(){this._container.className.indexOf("leaflet-control-geocoder-expanded")>=0?this._collapse():this._expand()},_expand:function(){n.DomUtil.addClass(this._container,"leaflet-control-geocoder-expanded"),this._input.select()},_collapse:function(){this._container.className=this._container.className.replace(" leaflet-control-geocoder-expanded",""),n.DomUtil.addClass(this._alts,"leaflet-control-geocoder-alternatives-minimized"),n.DomUtil.removeClass(this._errorElement,"leaflet-control-geocoder-error")},_clearResults:function(){n.DomUtil.addClass(this._alts,"leaflet-control-geocoder-alternatives-minimized"),this._selection=null,n.DomUtil.removeClass(this._errorElement,"leaflet-control-geocoder-error")},_createAlt:function(e,t){var i=n.DomUtil.create("li",""),o=n.DomUtil.create("a","",i),s=this.options.showResultIcons&&e.icon?n.DomUtil.create("img","",o):null,r=e.html?void 0:document.createTextNode(e.name),a=function(t){n.DomEvent.preventDefault(t),this._geocodeResultSelected(e)};return s&&(s.src=e.icon),i.setAttribute("data-result-index",t),e.html?o.innerHTML=e.html:o.appendChild(r),n.DomEvent.addListener(i,"click",a,this),i},_keydown:function(e){var t=this,i=function(e){t._selection&&(n.DomUtil.removeClass(t._selection,"leaflet-control-geocoder-selected"),t._selection=t._selection[e>0?"nextSibling":"previousSibling"]),t._selection||(t._selection=t._alts[e>0?"firstChild":"lastChild"]),t._selection&&n.DomUtil.addClass(t._selection,"leaflet-control-geocoder-selected")};switch(e.keyCode){case 27:this.options.collapsed&&this._collapse();break;case 38:i(-1),n.DomEvent.preventDefault(e);break;case 40:i(1),n.DomEvent.preventDefault(e);break;case 13:if(this._selection){var o=parseInt(this._selection.getAttribute("data-result-index"),10);this._geocodeResultSelected(this._results[o]),this._clearResults(),n.DomEvent.preventDefault(e)}}return!0}}),factory:function(e){return new n.Control.Geocoder(e)}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./geocoders/nominatim":7}],2:[function(e,t,i){(function(i){var n="undefined"!=typeof window?window.L:"undefined"!=typeof i?i.L:null,o=e("../util");t.exports={"class":n.Class.extend({initialize:function(e){this.key=e},geocode:function(e,t,i){o.jsonp("//dev.virtualearth.net/REST/v1/Locations",{query:e,key:this.key},function(e){var o=[];if(e.resourceSets.length>0)for(var s=e.resourceSets[0].resources.length-1;s>=0;s--){var r=e.resourceSets[0].resources[s],a=r.bbox;o[s]={name:r.name,bbox:n.latLngBounds([a[0],a[1]],[a[2],a[3]]),center:n.latLng(r.point.coordinates)}}t.call(i,o)},this,"jsonp")},reverse:function(e,t,i,s){o.jsonp("//dev.virtualearth.net/REST/v1/Locations/"+e.lat+","+e.lng,{key:this.key},function(e){for(var t=[],o=e.resourceSets[0].resources.length-1;o>=0;o--){var r=e.resourceSets[0].resources[o],a=r.bbox;t[o]={name:r.name,bbox:n.latLngBounds([a[0],a[1]],[a[2],a[3]]),center:n.latLng(r.point.coordinates)}}i.call(s,t)},this,"jsonp")}}),factory:function(e){return new n.Control.Geocoder.Bing(e)}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../util":11}],3:[function(e,t,i){(function(i){var n="undefined"!=typeof window?window.L:"undefined"!=typeof i?i.L:null,o=e("../util");t.exports={"class":n.Class.extend({options:{serviceUrl:"https://maps.googleapis.com/maps/api/geocode/json",geocodingQueryParams:{},reverseQueryParams:{}},initialize:function(e,t){this._key=e,n.setOptions(this,t),this.options.serviceUrl=this.options.service_url||this.options.serviceUrl},geocode:function(e,t,i){var s={address:e};this._key&&this._key.length&&(s.key=this._key),s=n.Util.extend(s,this.options.geocodingQueryParams),o.getJSON(this.options.serviceUrl,s,function(e){var o,s,r,a=[];if(e.results&&e.results.length)for(var l=0;l<=e.results.length-1;l++)o=e.results[l],s=n.latLng(o.geometry.location),r=n.latLngBounds(n.latLng(o.geometry.viewport.northeast),n.latLng(o.geometry.viewport.southwest)),a[l]={name:o.formatted_address,bbox:r,center:s,properties:o.address_components};t.call(i,a)})},reverse:function(e,t,i,s){var r={latlng:encodeURIComponent(e.lat)+","+encodeURIComponent(e.lng)};r=n.Util.extend(r,this.options.reverseQueryParams),this._key&&this._key.length&&(r.key=this._key),o.getJSON(this.options.serviceUrl,r,function(e){var t,o,r,a=[];if(e.results&&e.results.length)for(var l=0;l<=e.results.length-1;l++)t=e.results[l],o=n.latLng(t.geometry.location),r=n.latLngBounds(n.latLng(t.geometry.viewport.northeast),n.latLng(t.geometry.viewport.southwest)),a[l]={name:t.formatted_address,bbox:r,center:o,properties:t.address_components};i.call(s,a)})}}),factory:function(e,t){return new n.Control.Geocoder.Google(e,t)}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../util":11}],4:[function(e,t,i){(function(i){var n="undefined"!=typeof window?window.L:"undefined"!=typeof i?i.L:null,o=e("../util");t.exports={"class":n.Class.extend({options:{serviceUrl:"https://api.tiles.mapbox.com/v4/geocode/mapbox.places-v1/"},initialize:function(e,t){n.setOptions(this,t),this._accessToken=e},geocode:function(e,t,i){o.getJSON(this.options.serviceUrl+encodeURIComponent(e)+".json",{access_token:this._accessToken},function(e){var o,s,r,a=[];if(e.features&&e.features.length)for(var l=0;l<=e.features.length-1;l++)o=e.features[l],s=n.latLng(o.center.reverse()),r=o.hasOwnProperty("bbox")?n.latLngBounds(n.latLng(o.bbox.slice(0,2).reverse()),n.latLng(o.bbox.slice(2,4).reverse())):n.latLngBounds(s,s),a[l]={name:o.place_name,bbox:r,center:s};t.call(i,a)})},suggest:function(e,t,i){return this.geocode(e,t,i)},reverse:function(e,t,i,s){o.getJSON(this.options.serviceUrl+encodeURIComponent(e.lng)+","+encodeURIComponent(e.lat)+".json",{access_token:this._accessToken},function(e){var t,o,r,a=[];if(e.features&&e.features.length)for(var l=0;l<=e.features.length-1;l++)t=e.features[l],o=n.latLng(t.center.reverse()),r=t.hasOwnProperty("bbox")?n.latLngBounds(n.latLng(t.bbox.slice(0,2).reverse()),n.latLng(t.bbox.slice(2,4).reverse())):n.latLngBounds(o,o),a[l]={name:t.place_name,bbox:r,center:o};i.call(s,a)})}}),factory:function(e,t){return new n.Control.Geocoder.Mapbox(e,t)}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../util":11}],5:[function(e,t,i){(function(i){var n="undefined"!=typeof window?window.L:"undefined"!=typeof i?i.L:null,o=e("../util");t.exports={"class":n.Class.extend({options:{serviceUrl:"//www.mapquestapi.com/geocoding/v1"},initialize:function(e,t){this._key=decodeURIComponent(e),n.Util.setOptions(this,t)},_formatName:function(){var e,t=[];for(e=0;e<arguments.length;e++)arguments[e]&&t.push(arguments[e]);return t.join(", ")},geocode:function(e,t,i){o.jsonp(this.options.serviceUrl+"/address",{key:this._key,location:e,limit:5,outFormat:"json"},function(e){var o,s,r=[];if(e.results&&e.results[0].locations)for(var a=e.results[0].locations.length-1;a>=0;a--)o=e.results[0].locations[a],s=n.latLng(o.latLng),r[a]={name:this._formatName(o.street,o.adminArea4,o.adminArea3,o.adminArea1),bbox:n.latLngBounds(s,s),center:s};t.call(i,r)},this)},reverse:function(e,t,i,s){o.jsonp(this.options.serviceUrl+"/reverse",{key:this._key,location:e.lat+","+e.lng,outputFormat:"json"},function(e){var t,o,r=[];if(e.results&&e.results[0].locations)for(var a=e.results[0].locations.length-1;a>=0;a--)t=e.results[0].locations[a],o=n.latLng(t.latLng),r[a]={name:this._formatName(t.street,t.adminArea4,t.adminArea3,t.adminArea1),bbox:n.latLngBounds(o,o),center:o};i.call(s,r)},this)}}),factory:function(e,t){return new n.Control.Geocoder.MapQuest(e,t)}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../util":11}],6:[function(e,t,i){(function(i){var n="undefined"!=typeof window?window.L:"undefined"!=typeof i?i.L:null,o=e("../util");t.exports={"class":n.Class.extend({options:{serviceUrl:"//search.mapzen.com/v1",geocodingQueryParams:{},reverseQueryParams:{}},initialize:function(e,t){n.Util.setOptions(this,t),this._apiKey=e,this._lastSuggest=0},geocode:function(e,t,i){var s=this;o.getJSON(this.options.serviceUrl+"/search",n.extend({api_key:this._apiKey,text:e},this.options.geocodingQueryParams),function(e){t.call(i,s._parseResults(e,"bbox"))})},suggest:function(e,t,i){var s=this;o.getJSON(this.options.serviceUrl+"/autocomplete",n.extend({api_key:this._apiKey,text:e},this.options.geocodingQueryParams),function(e){e.geocoding.timestamp>this._lastSuggest&&(this._lastSuggest=e.geocoding.timestamp,t.call(i,s._parseResults(e,"bbox")))})},reverse:function(e,t,i,s){var r=this;o.getJSON(this.options.serviceUrl+"/reverse",n.extend({api_key:this._apiKey,"point.lat":e.lat,"point.lon":e.lng},this.options.reverseQueryParams),function(e){i.call(s,r._parseResults(e,"bounds"))})},_parseResults:function(e,t){var i=[];return n.geoJson(e,{pointToLayer:function(e,t){return n.circleMarker(t)},onEachFeature:function(e,n){var o={};o.name=n.feature.properties.label,o[t]=n.getBounds(),o.center=o[t].getCenter(),o.properties=n.feature.properties,i.push(o)}}),i}}),factory:function(e,t){return new n.Control.Geocoder.Mapzen(e,t)}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../util":11}],7:[function(e,t,i){(function(i){var n="undefined"!=typeof window?window.L:"undefined"!=typeof i?i.L:null,o=e("../util");t.exports={"class":n.Class.extend({options:{serviceUrl:"//nominatim.openstreetmap.org/",geocodingQueryParams:{},reverseQueryParams:{},htmlTemplate:function(e){var t=e.address,i=[];return(t.road||t.building)&&i.push("{building} {road} {house_number}"),(t.city||t.town||t.village)&&i.push('<span class="'+(i.length>0?"leaflet-control-geocoder-address-detail":"")+'">{postcode} {city} {town} {village}</span>'),(t.state||t.country)&&i.push('<span class="'+(i.length>0?"leaflet-control-geocoder-address-context":"")+'">{state} {country}</span>'),o.template(i.join("<br/>"),t,!0)}},initialize:function(e){n.Util.setOptions(this,e)},geocode:function(e,t,i){o.jsonp(this.options.serviceUrl+"search",n.extend({q:e,limit:5,format:"json",addressdetails:1},this.options.geocodingQueryParams),function(e){for(var o=[],s=e.length-1;s>=0;s--){for(var r=e[s].boundingbox,a=0;4>a;a++)r[a]=parseFloat(r[a]);o[s]={icon:e[s].icon,name:e[s].display_name,html:this.options.htmlTemplate?this.options.htmlTemplate(e[s]):void 0,bbox:n.latLngBounds([r[0],r[2]],[r[1],r[3]]),center:n.latLng(e[s].lat,e[s].lon),properties:e[s]}}t.call(i,o)},this,"json_callback")},reverse:function(e,t,i,s){o.jsonp(this.options.serviceUrl+"reverse",n.extend({lat:e.lat,lon:e.lng,zoom:Math.round(Math.log(t/256)/Math.log(2)),addressdetails:1,format:"json"},this.options.reverseQueryParams),function(e){var t,o=[];e&&e.lat&&e.lon&&(t=n.latLng(e.lat,e.lon),o.push({name:e.display_name,html:this.options.htmlTemplate?this.options.htmlTemplate(e):void 0,center:t,bounds:n.latLngBounds(t,t),properties:e})),i.call(s,o)},this,"json_callback")}}),factory:function(e){return new n.Control.Geocoder.Nominatim(e)}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../util":11}],8:[function(e,t,i){(function(i){var n="undefined"!=typeof window?window.L:"undefined"!=typeof i?i.L:null,o=e("../util");t.exports={"class":n.Class.extend({options:{serviceUrl:"//photon.komoot.de/api/",reverseUrl:"//photon.komoot.de/reverse/",nameProperties:["name","street","suburb","hamlet","town","city","state","country"]},initialize:function(e){n.setOptions(this,e)},geocode:function(e,t,i){var s=n.extend({q:e},this.options.geocodingQueryParams);o.getJSON(this.options.serviceUrl,s,n.bind(function(e){t.call(i,this._decodeFeatures(e))},this))},suggest:function(e,t,i){return this.geocode(e,t,i)},reverse:function(e,t,i,s){var r=n.extend({lat:e.lat,lon:e.lng},this.options.geocodingQueryParams);o.getJSON(this.options.reverseUrl,r,n.bind(function(e){i.call(s,this._decodeFeatures(e))},this))},_decodeFeatures:function(e){var t,i,o,s,r,a,l=[];if(e&&e.features)for(t=0;t<e.features.length;t++)i=e.features[t],o=i.geometry.coordinates,s=n.latLng(o[1],o[0]),r=i.properties.extent,a=r?n.latLngBounds([r[1],r[0]],[r[3],r[2]]):n.latLngBounds(s,s),l.push({name:this._deocodeFeatureName(i),center:s,bbox:a,properties:i.properties});return l},_deocodeFeatureName:function(e){var t,i;for(t=0;!i&&t<this.options.nameProperties.length;t++)i=e.properties[this.options.nameProperties[t]];return i}}),factory:function(e){return new n.Control.Geocoder.Photon(e)}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../util":11}],9:[function(e,t,i){(function(i){var n="undefined"!=typeof window?window.L:"undefined"!=typeof i?i.L:null,o=e("../util");t.exports={"class":n.Class.extend({options:{serviceUrl:"http://api.what3words.com/"},initialize:function(e){this._accessToken=e},geocode:function(e,t,i){o.getJSON(this.options.serviceUrl+"w3w",{key:this._accessToken,string:e.split(/\s+/).join(".")},function(e){var o,s,r,a=[];e.position&&e.position.length&&(o=e.words,s=n.latLng(e.position[0],e.position[1]),r=n.latLngBounds(s,s),a[0]={name:o.join("."),bbox:r,center:s}),t.call(i,a)})},suggest:function(e,t,i){return this.geocode(e,t,i)},reverse:function(e,t,i,s){o.getJSON(this.options.serviceUrl+"position",{key:this._accessToken,position:[e.lat,e.lng].join(",")},function(e){var t,o,r,a=[];e.position&&e.position.length&&(t=e.words,o=n.latLng(e.position[0],e.position[1]),r=n.latLngBounds(o,o),a[0]={name:t.join("."),bbox:r,center:o}),i.call(s,a)})}}),factory:function(e){return new n.Control.Geocoder.What3Words(e)}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../util":11}],10:[function(e,t,i){(function(i){var n="undefined"!=typeof window?window.L:"undefined"!=typeof i?i.L:null,o=e("./control"),s=e("./geocoders/nominatim"),r=e("./geocoders/bing"),a=e("./geocoders/mapquest"),l=e("./geocoders/mapbox"),u=e("./geocoders/what3words"),d=e("./geocoders/google"),h=e("./geocoders/photon"),c=e("./geocoders/mapzen");t.exports=n.Util.extend(o["class"],{Nominatim:s["class"],nominatim:s.factory,Bing:r["class"],bing:r.factory,MapQuest:a["class"],mapQuest:a.factory,Mapbox:l["class"],mapbox:l.factory,What3Words:u["class"],what3words:u.factory,Google:d["class"],google:d.factory,Photon:h["class"],photon:h.factory,Mapzen:c["class"],mapzen:c.factory}),n.Util.extend(n.Control,{Geocoder:t.exports,geocoder:o.factory})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./control":1,"./geocoders/bing":2,"./geocoders/google":3,"./geocoders/mapbox":4,"./geocoders/mapquest":5,"./geocoders/mapzen":6,"./geocoders/nominatim":7,"./geocoders/photon":8,"./geocoders/what3words":9}],11:[function(e,t,i){(function(e){var i="undefined"!=typeof window?window.L:"undefined"!=typeof e?e.L:null,n=0,o=function(){function e(e){return n[e]}var t=/[&<>"'`]/g,i=/[&<>"'`]/,n={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"};return function(n){return null==n?"":n?(n=""+n,i.test(n)?n.replace(t,e):n):n+""}}();t.exports={jsonp:function(e,t,o,s,r){var a="_l_geocoder_"+n++;t[r||"callback"]=a,window[a]=i.Util.bind(o,s);var l=document.createElement("script");l.type="text/javascript",l.src=e+i.Util.getParamString(t),l.id=a,document.getElementsByTagName("head")[0].appendChild(l)},getJSON:function(e,t,n){var o=new XMLHttpRequest;o.onreadystatechange=function(){return 4===o.readyState?200!==o.status&&304!==o.status?void n(""):void n(JSON.parse(o.response)):void 0},o.open("GET",e+i.Util.getParamString(t),!0),o.setRequestHeader("Accept","application/json"),o.send(null)},template:function(e,t){return e.replace(/\{ *([\w_]+) *\}/g,function(e,i){var n=t[i];return void 0===n?n="":"function"==typeof n&&(n=n(t)),o(n)})},htmlEscape:o}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[10]);var openstreet=L.tileLayer("https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoiZXJpY3RhbjgwIiwiYSI6ImNpZzUyNjNwbzNra3h1d2x2ZnV5OXFjZWIifQ.4WXMlCNO32swLF4_JH7b_g",{attribution:'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery ? <a href="http://mapbox.com">Mapbox</a>',maxZoom:18,id:"erictan80.npmpe852",accessToken:"pk.eyJ1IjoiZXJpY3RhbjgwIiwiYSI6ImNpZzUyNjNwbzNra3h1d2x2ZnV5OXFjZWIifQ.4WXMlCNO32swLF4_JH7b_g"}),map=L.map("map",{layers:[openstreet]}),markers=new L.MarkerClusterGroup,bounds=[];$.getJSON("/user",function(e){$.each(e,function(e,t){var i=new L.Marker([t.lat,t.lng]);markers.addLayer(i),bounds.push([t.lat,t.lng])}),map.addLayer(markers),map.fitBounds(bounds,{padding:[20,20]})}),!function(e,t){L.MarkerClusterGroup=L.FeatureGroup.extend({options:{maxClusterRadius:80,iconCreateFunction:null,spiderfyOnMaxZoom:!0,showCoverageOnHover:!0,zoomToBoundsOnClick:!0,singleMarkerMode:!1,disableClusteringAtZoom:null,removeOutsideVisibleBounds:!0,animateAddingMarkers:!1,spiderfyDistanceMultiplier:1,polygonOptions:{}},initialize:function(e){L.Util.setOptions(this,e),this.options.iconCreateFunction||(this.options.iconCreateFunction=this._defaultIconCreateFunction),this._featureGroup=L.featureGroup(),this._featureGroup.on(L.FeatureGroup.EVENTS,this._propagateEvent,this),this._nonPointGroup=L.featureGroup(),this._nonPointGroup.on(L.FeatureGroup.EVENTS,this._propagateEvent,this),this._inZoomAnimation=0,this._needsClustering=[],this._needsRemoving=[],this._currentShownBounds=null,this._queue=[]},addLayer:function(e){if(e instanceof L.LayerGroup){var t=[];for(var i in e._layers)t.push(e._layers[i]);return this.addLayers(t)}if(!e.getLatLng)return this._nonPointGroup.addLayer(e),this;if(!this._map)return this._needsClustering.push(e),this;if(this.hasLayer(e))return this;this._unspiderfy&&this._unspiderfy(),this._addLayer(e,this._maxZoom);var n=e,o=this._map.getZoom();if(e.__parent)for(;n.__parent._zoom>=o;)n=n.__parent;return this._currentShownBounds.contains(n.getLatLng())&&(this.options.animateAddingMarkers?this._animationAddLayer(e,n):this._animationAddLayerNonAnimated(e,n)),this},removeLayer:function(e){if(e instanceof L.LayerGroup){var t=[];for(var i in e._layers)t.push(e._layers[i]);return this.removeLayers(t)}return e.getLatLng?this._map?e.__parent?(this._unspiderfy&&(this._unspiderfy(),this._unspiderfyLayer(e)),this._removeLayer(e,!0),this._featureGroup.hasLayer(e)&&(this._featureGroup.removeLayer(e),e.setOpacity&&e.setOpacity(1)),this):this:(!this._arraySplice(this._needsClustering,e)&&this.hasLayer(e)&&this._needsRemoving.push(e),this):(this._nonPointGroup.removeLayer(e),this)},addLayers:function(e){var t,i,n,o=this._map,s=this._featureGroup,r=this._nonPointGroup;for(t=0,i=e.length;i>t;t++)if(n=e[t],n.getLatLng){if(!this.hasLayer(n))if(o){if(this._addLayer(n,this._maxZoom),n.__parent&&2===n.__parent.getChildCount()){var a=n.__parent.getAllChildMarkers(),l=a[0]===n?a[1]:a[0];s.removeLayer(l)}}else this._needsClustering.push(n)}else r.addLayer(n);return o&&(s.eachLayer(function(e){e instanceof L.MarkerCluster&&e._iconNeedsUpdate&&e._updateIcon()}),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds)),this},removeLayers:function(e){var t,i,n,o=this._featureGroup,s=this._nonPointGroup;if(!this._map){for(t=0,i=e.length;i>t;t++)n=e[t],this._arraySplice(this._needsClustering,n),s.removeLayer(n);return this}for(t=0,i=e.length;i>t;t++)n=e[t],n.__parent?(this._removeLayer(n,!0,!0),o.hasLayer(n)&&(o.removeLayer(n),n.setOpacity&&n.setOpacity(1))):s.removeLayer(n);return this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds),o.eachLayer(function(e){e instanceof L.MarkerCluster&&e._updateIcon()}),this},clearLayers:function(){return this._map||(this._needsClustering=[],delete this._gridClusters,delete this._gridUnclustered),this._noanimationUnspiderfy&&this._noanimationUnspiderfy(),this._featureGroup.clearLayers(),this._nonPointGroup.clearLayers(),this.eachLayer(function(e){delete e.__parent}),this._map&&this._generateInitialClusters(),this},getBounds:function(){var e=new L.LatLngBounds;if(this._topClusterLevel)e.extend(this._topClusterLevel._bounds);else for(var t=this._needsClustering.length-1;t>=0;t--)e.extend(this._needsClustering[t].getLatLng());return e.extend(this._nonPointGroup.getBounds()),e},eachLayer:function(e,t){var i,n=this._needsClustering.slice();for(this._topClusterLevel&&this._topClusterLevel.getAllChildMarkers(n),i=n.length-1;i>=0;i--)e.call(t,n[i]);this._nonPointGroup.eachLayer(e,t)},getLayers:function(){var e=[];return this.eachLayer(function(t){e.push(t)}),e},getLayer:function(e){var t=null;return this.eachLayer(function(i){L.stamp(i)===e&&(t=i)}),t},hasLayer:function(e){if(!e)return!1;var t,i=this._needsClustering;for(t=i.length-1;t>=0;t--)if(i[t]===e)return!0;for(i=this._needsRemoving,t=i.length-1;t>=0;t--)if(i[t]===e)return!1;return!(!e.__parent||e.__parent._group!==this)||this._nonPointGroup.hasLayer(e)},zoomToShowLayer:function(e,t){var i=function(){if((e._icon||e.__parent._icon)&&!this._inZoomAnimation)if(this._map.off("moveend",i,this),this.off("animationend",i,this),e._icon)t();else if(e.__parent._icon){var n=function(){this.off("spiderfied",n,this),t()};this.on("spiderfied",n,this),e.__parent.spiderfy()}};e._icon&&this._map.getBounds().contains(e.getLatLng())?t():e.__parent._zoom<this._map.getZoom()?(this._map.on("moveend",i,this),this._map.panTo(e.getLatLng())):(this._map.on("moveend",i,this),this.on("animationend",i,this),this._map.setView(e.getLatLng(),e.__parent._zoom+1),e.__parent.zoomToBounds())},onAdd:function(e){this._map=e;var t,i,n;if(!isFinite(this._map.getMaxZoom()))throw"Map has no maxZoom specified";for(this._featureGroup.onAdd(e),this._nonPointGroup.onAdd(e),this._gridClusters||this._generateInitialClusters(),t=0,i=this._needsRemoving.length;i>t;t++)n=this._needsRemoving[t],this._removeLayer(n,!0);for(this._needsRemoving=[],t=0,i=this._needsClustering.length;i>t;t++)n=this._needsClustering[t],n.getLatLng?n.__parent||this._addLayer(n,this._maxZoom):this._featureGroup.addLayer(n);this._needsClustering=[],this._map.on("zoomend",this._zoomEnd,this),this._map.on("moveend",this._moveEnd,this),this._spiderfierOnAdd&&this._spiderfierOnAdd(),this._bindEvents(),this._zoom=this._map.getZoom(),this._currentShownBounds=this._getExpandedVisibleBounds(),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds)},onRemove:function(e){e.off("zoomend",this._zoomEnd,this),e.off("moveend",this._moveEnd,this),this._unbindEvents(),this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim",""),this._spiderfierOnRemove&&this._spiderfierOnRemove(),this._hideCoverage(),this._featureGroup.onRemove(e),this._nonPointGroup.onRemove(e),this._featureGroup.clearLayers(),this._map=null},getVisibleParent:function(e){for(var t=e;t&&!t._icon;)t=t.__parent;return t||null},_arraySplice:function(e,t){for(var i=e.length-1;i>=0;i--)if(e[i]===t)return e.splice(i,1),!0},_removeLayer:function(e,t,i){var n=this._gridClusters,o=this._gridUnclustered,s=this._featureGroup,r=this._map;if(t)for(var a=this._maxZoom;a>=0&&o[a].removeObject(e,r.project(e.getLatLng(),a));a--);var l,u=e.__parent,d=u._markers;for(this._arraySplice(d,e);u&&(u._childCount--,!(u._zoom<0));)t&&u._childCount<=1?(l=u._markers[0]===e?u._markers[1]:u._markers[0],n[u._zoom].removeObject(u,r.project(u._cLatLng,u._zoom)),o[u._zoom].addObject(l,r.project(l.getLatLng(),u._zoom)),this._arraySplice(u.__parent._childClusters,u),u.__parent._markers.push(l),l.__parent=u.__parent,u._icon&&(s.removeLayer(u),i||s.addLayer(l))):(u._recalculateBounds(),i&&u._icon||u._updateIcon()),u=u.__parent;delete e.__parent},_isOrIsParent:function(e,t){for(;t;){if(e===t)return!0;t=t.parentNode}return!1},_propagateEvent:function(e){if(e.layer instanceof L.MarkerCluster){if(e.originalEvent&&this._isOrIsParent(e.layer._icon,e.originalEvent.relatedTarget))return;e.type="cluster"+e.type}this.fire(e.type,e)},_defaultIconCreateFunction:function(e){var t=e.getChildCount(),i=" marker-cluster-";return i+=10>t?"small":100>t?"medium":"large",new L.DivIcon({html:"<div><span>"+t+"</span></div>",className:"marker-cluster"+i,iconSize:new L.Point(40,40)})},_bindEvents:function(){var e=this._map,t=this.options.spiderfyOnMaxZoom,i=this.options.showCoverageOnHover,n=this.options.zoomToBoundsOnClick;(t||n)&&this.on("clusterclick",this._zoomOrSpiderfy,this),i&&(this.on("clustermouseover",this._showCoverage,this),this.on("clustermouseout",this._hideCoverage,this),e.on("zoomend",this._hideCoverage,this))},_zoomOrSpiderfy:function(e){var t=this._map;t.getMaxZoom()===t.getZoom()?this.options.spiderfyOnMaxZoom&&e.layer.spiderfy():this.options.zoomToBoundsOnClick&&e.layer.zoomToBounds(),e.originalEvent&&13===e.originalEvent.keyCode&&t._container.focus()},_showCoverage:function(e){var t=this._map;this._inZoomAnimation||(this._shownPolygon&&t.removeLayer(this._shownPolygon),e.layer.getChildCount()>2&&e.layer!==this._spiderfied&&(this._shownPolygon=new L.Polygon(e.layer.getConvexHull(),this.options.polygonOptions),t.addLayer(this._shownPolygon)))},_hideCoverage:function(){this._shownPolygon&&(this._map.removeLayer(this._shownPolygon),this._shownPolygon=null)},_unbindEvents:function(){var e=this.options.spiderfyOnMaxZoom,t=this.options.showCoverageOnHover,i=this.options.zoomToBoundsOnClick,n=this._map;(e||i)&&this.off("clusterclick",this._zoomOrSpiderfy,this),t&&(this.off("clustermouseover",this._showCoverage,this),this.off("clustermouseout",this._hideCoverage,this),n.off("zoomend",this._hideCoverage,this))},_zoomEnd:function(){this._map&&(this._mergeSplitClusters(),this._zoom=this._map._zoom,this._currentShownBounds=this._getExpandedVisibleBounds())},_moveEnd:function(){if(!this._inZoomAnimation){var e=this._getExpandedVisibleBounds();this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,this._zoom,e),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._map._zoom,e),this._currentShownBounds=e}},_generateInitialClusters:function(){var e=this._map.getMaxZoom(),t=this.options.maxClusterRadius;this.options.disableClusteringAtZoom&&(e=this.options.disableClusteringAtZoom-1),this._maxZoom=e,this._gridClusters={},this._gridUnclustered={};for(var i=e;i>=0;i--)this._gridClusters[i]=new L.DistanceGrid(t),this._gridUnclustered[i]=new L.DistanceGrid(t);this._topClusterLevel=new L.MarkerCluster(this,-1)},_addLayer:function(e,t){var i,n,o=this._gridClusters,s=this._gridUnclustered;for(this.options.singleMarkerMode&&(e.options.icon=this.options.iconCreateFunction({getChildCount:function(){return 1},getAllChildMarkers:function(){return[e]}}));t>=0;t--){i=this._map.project(e.getLatLng(),t);var r=o[t].getNearObject(i);if(r)return r._addChild(e),void(e.__parent=r);if(r=s[t].getNearObject(i)){var a=r.__parent;a&&this._removeLayer(r,!1);var l=new L.MarkerCluster(this,t,r,e);o[t].addObject(l,this._map.project(l._cLatLng,t)),r.__parent=l,e.__parent=l;var u=l;for(n=t-1;n>a._zoom;n--)u=new L.MarkerCluster(this,n,u),o[n].addObject(u,this._map.project(r.getLatLng(),n));for(a._addChild(u),n=t;n>=0&&s[n].removeObject(r,this._map.project(r.getLatLng(),n));n--);return}s[t].addObject(e,i)}this._topClusterLevel._addChild(e),e.__parent=this._topClusterLevel},_enqueue:function(e){this._queue.push(e),this._queueTimeout||(this._queueTimeout=setTimeout(L.bind(this._processQueue,this),300))},_processQueue:function(){for(var e=0;e<this._queue.length;e++)this._queue[e].call(this);this._queue.length=0,clearTimeout(this._queueTimeout),this._queueTimeout=null},_mergeSplitClusters:function(){this._processQueue(),this._zoom<this._map._zoom&&this._currentShownBounds.contains(this._getExpandedVisibleBounds())?(this._animationStart(),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,this._zoom,this._getExpandedVisibleBounds()),this._animationZoomIn(this._zoom,this._map._zoom)):this._zoom>this._map._zoom?(this._animationStart(),this._animationZoomOut(this._zoom,this._map._zoom)):this._moveEnd()},_getExpandedVisibleBounds:function(){if(!this.options.removeOutsideVisibleBounds)return this.getBounds();var e=this._map,t=e.getBounds(),i=t._southWest,n=t._northEast,o=L.Browser.mobile?0:Math.abs(i.lat-n.lat),s=L.Browser.mobile?0:Math.abs(i.lng-n.lng);return new L.LatLngBounds(new L.LatLng(i.lat-o,i.lng-s,!0),new L.LatLng(n.lat+o,n.lng+s,!0))},_animationAddLayerNonAnimated:function(e,t){if(t===e)this._featureGroup.addLayer(e);else if(2===t._childCount){t._addToMap();var i=t.getAllChildMarkers();
this._featureGroup.removeLayer(i[0]),this._featureGroup.removeLayer(i[1])}else t._updateIcon()}}),L.MarkerClusterGroup.include(L.DomUtil.TRANSITION?{_animationStart:function(){this._map._mapPane.className+=" leaflet-cluster-anim",this._inZoomAnimation++},_animationEnd:function(){this._map&&(this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim","")),this._inZoomAnimation--,this.fire("animationend")},_animationZoomIn:function(e,t){var i,n=this._getExpandedVisibleBounds(),o=this._featureGroup;this._topClusterLevel._recursively(n,e,0,function(s){var r,a=s._latlng,l=s._markers;for(n.contains(a)||(a=null),s._isSingleParent()&&e+1===t?(o.removeLayer(s),s._recursivelyAddChildrenToMap(null,t,n)):(s.setOpacity(0),s._recursivelyAddChildrenToMap(a,t,n)),i=l.length-1;i>=0;i--)r=l[i],n.contains(r._latlng)||o.removeLayer(r)}),this._forceLayout(),this._topClusterLevel._recursivelyBecomeVisible(n,t),o.eachLayer(function(e){e instanceof L.MarkerCluster||!e._icon||e.setOpacity(1)}),this._topClusterLevel._recursively(n,e,t,function(e){e._recursivelyRestoreChildPositions(t)}),this._enqueue(function(){this._topClusterLevel._recursively(n,e,0,function(e){o.removeLayer(e),e.setOpacity(1)}),this._animationEnd()})},_animationZoomOut:function(e,t){this._animationZoomOutSingle(this._topClusterLevel,e-1,t),this._topClusterLevel._recursivelyAddChildrenToMap(null,t,this._getExpandedVisibleBounds()),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,e,this._getExpandedVisibleBounds())},_animationZoomOutSingle:function(e,t,i){var n=this._getExpandedVisibleBounds();e._recursivelyAnimateChildrenInAndAddSelfToMap(n,t+1,i);var o=this;this._forceLayout(),e._recursivelyBecomeVisible(n,i),this._enqueue(function(){if(1===e._childCount){var s=e._markers[0];s.setLatLng(s.getLatLng()),s.setOpacity(1)}else e._recursively(n,i,0,function(e){e._recursivelyRemoveChildrenFromMap(n,t+1)});o._animationEnd()})},_animationAddLayer:function(e,t){var i=this,n=this._featureGroup;n.addLayer(e),t!==e&&(t._childCount>2?(t._updateIcon(),this._forceLayout(),this._animationStart(),e._setPos(this._map.latLngToLayerPoint(t.getLatLng())),e.setOpacity(0),this._enqueue(function(){n.removeLayer(e),e.setOpacity(1),i._animationEnd()})):(this._forceLayout(),i._animationStart(),i._animationZoomOutSingle(t,this._map.getMaxZoom(),this._map.getZoom())))},_forceLayout:function(){L.Util.falseFn(t.body.offsetWidth)}}:{_animationStart:function(){},_animationZoomIn:function(e,t){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,e),this._topClusterLevel._recursivelyAddChildrenToMap(null,t,this._getExpandedVisibleBounds())},_animationZoomOut:function(e,t){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,e),this._topClusterLevel._recursivelyAddChildrenToMap(null,t,this._getExpandedVisibleBounds())},_animationAddLayer:function(e,t){this._animationAddLayerNonAnimated(e,t)}}),L.markerClusterGroup=function(e){return new L.MarkerClusterGroup(e)},L.MarkerCluster=L.Marker.extend({initialize:function(e,t,i,n){L.Marker.prototype.initialize.call(this,i?i._cLatLng||i.getLatLng():new L.LatLng(0,0),{icon:this}),this._group=e,this._zoom=t,this._markers=[],this._childClusters=[],this._childCount=0,this._iconNeedsUpdate=!0,this._bounds=new L.LatLngBounds,i&&this._addChild(i),n&&this._addChild(n)},getAllChildMarkers:function(e){e=e||[];for(var t=this._childClusters.length-1;t>=0;t--)this._childClusters[t].getAllChildMarkers(e);for(var i=this._markers.length-1;i>=0;i--)e.push(this._markers[i]);return e},getChildCount:function(){return this._childCount},zoomToBounds:function(){for(var e,t=this._childClusters.slice(),i=this._group._map,n=i.getBoundsZoom(this._bounds),o=this._zoom+1,s=i.getZoom();t.length>0&&n>o;){o++;var r=[];for(e=0;e<t.length;e++)r=r.concat(t[e]._childClusters);t=r}n>o?this._group._map.setView(this._latlng,o):s>=n?this._group._map.setView(this._latlng,s+1):this._group._map.fitBounds(this._bounds)},getBounds:function(){var e=new L.LatLngBounds;return e.extend(this._bounds),e},_updateIcon:function(){this._iconNeedsUpdate=!0,this._icon&&this.setIcon(this)},createIcon:function(){return this._iconNeedsUpdate&&(this._iconObj=this._group.options.iconCreateFunction(this),this._iconNeedsUpdate=!1),this._iconObj.createIcon()},createShadow:function(){return this._iconObj.createShadow()},_addChild:function(e,t){this._iconNeedsUpdate=!0,this._expandBounds(e),e instanceof L.MarkerCluster?(t||(this._childClusters.push(e),e.__parent=this),this._childCount+=e._childCount):(t||this._markers.push(e),this._childCount++),this.__parent&&this.__parent._addChild(e,!0)},_expandBounds:function(e){var t,i=e._wLatLng||e._latlng;e instanceof L.MarkerCluster?(this._bounds.extend(e._bounds),t=e._childCount):(this._bounds.extend(i),t=1),this._cLatLng||(this._cLatLng=e._cLatLng||i);var n=this._childCount+t;this._wLatLng?(this._wLatLng.lat=(i.lat*t+this._wLatLng.lat*this._childCount)/n,this._wLatLng.lng=(i.lng*t+this._wLatLng.lng*this._childCount)/n):this._latlng=this._wLatLng=new L.LatLng(i.lat,i.lng)},_addToMap:function(e){e&&(this._backupLatlng=this._latlng,this.setLatLng(e)),this._group._featureGroup.addLayer(this)},_recursivelyAnimateChildrenIn:function(e,t,i){this._recursively(e,0,i-1,function(e){var i,n,o=e._markers;for(i=o.length-1;i>=0;i--)n=o[i],n._icon&&(n._setPos(t),n.setOpacity(0))},function(e){var i,n,o=e._childClusters;for(i=o.length-1;i>=0;i--)n=o[i],n._icon&&(n._setPos(t),n.setOpacity(0))})},_recursivelyAnimateChildrenInAndAddSelfToMap:function(e,t,i){this._recursively(e,i,0,function(n){n._recursivelyAnimateChildrenIn(e,n._group._map.latLngToLayerPoint(n.getLatLng()).round(),t),n._isSingleParent()&&t-1===i?(n.setOpacity(1),n._recursivelyRemoveChildrenFromMap(e,t)):n.setOpacity(0),n._addToMap()})},_recursivelyBecomeVisible:function(e,t){this._recursively(e,0,t,null,function(e){e.setOpacity(1)})},_recursivelyAddChildrenToMap:function(e,t,i){this._recursively(i,-1,t,function(n){if(t!==n._zoom)for(var o=n._markers.length-1;o>=0;o--){var s=n._markers[o];i.contains(s._latlng)&&(e&&(s._backupLatlng=s.getLatLng(),s.setLatLng(e),s.setOpacity&&s.setOpacity(0)),n._group._featureGroup.addLayer(s))}},function(t){t._addToMap(e)})},_recursivelyRestoreChildPositions:function(e){for(var t=this._markers.length-1;t>=0;t--){var i=this._markers[t];i._backupLatlng&&(i.setLatLng(i._backupLatlng),delete i._backupLatlng)}if(e-1===this._zoom)for(var n=this._childClusters.length-1;n>=0;n--)this._childClusters[n]._restorePosition();else for(var o=this._childClusters.length-1;o>=0;o--)this._childClusters[o]._recursivelyRestoreChildPositions(e)},_restorePosition:function(){this._backupLatlng&&(this.setLatLng(this._backupLatlng),delete this._backupLatlng)},_recursivelyRemoveChildrenFromMap:function(e,t,i){var n,o;this._recursively(e,-1,t-1,function(e){for(o=e._markers.length-1;o>=0;o--)n=e._markers[o],i&&i.contains(n._latlng)||(e._group._featureGroup.removeLayer(n),n.setOpacity&&n.setOpacity(1))},function(e){for(o=e._childClusters.length-1;o>=0;o--)n=e._childClusters[o],i&&i.contains(n._latlng)||(e._group._featureGroup.removeLayer(n),n.setOpacity&&n.setOpacity(1))})},_recursively:function(e,t,i,n,o){var s,r,a=this._childClusters,l=this._zoom;if(t>l)for(s=a.length-1;s>=0;s--)r=a[s],e.intersects(r._bounds)&&r._recursively(e,t,i,n,o);else if(n&&n(this),o&&this._zoom===i&&o(this),i>l)for(s=a.length-1;s>=0;s--)r=a[s],e.intersects(r._bounds)&&r._recursively(e,t,i,n,o)},_recalculateBounds:function(){var e,t=this._markers,i=this._childClusters;for(this._bounds=new L.LatLngBounds,delete this._wLatLng,e=t.length-1;e>=0;e--)this._expandBounds(t[e]);for(e=i.length-1;e>=0;e--)this._expandBounds(i[e])},_isSingleParent:function(){return this._childClusters.length>0&&this._childClusters[0]._childCount===this._childCount}}),L.DistanceGrid=function(e){this._cellSize=e,this._sqCellSize=e*e,this._grid={},this._objectPoint={}},L.DistanceGrid.prototype={addObject:function(e,t){var i=this._getCoord(t.x),n=this._getCoord(t.y),o=this._grid,s=o[n]=o[n]||{},r=s[i]=s[i]||[],a=L.Util.stamp(e);this._objectPoint[a]=t,r.push(e)},updateObject:function(e,t){this.removeObject(e),this.addObject(e,t)},removeObject:function(e,t){var i,n,o=this._getCoord(t.x),s=this._getCoord(t.y),r=this._grid,a=r[s]=r[s]||{},l=a[o]=a[o]||[];for(delete this._objectPoint[L.Util.stamp(e)],i=0,n=l.length;n>i;i++)if(l[i]===e)return l.splice(i,1),1===n&&delete a[o],!0},eachObject:function(e,t){var i,n,o,s,r,a,l,u=this._grid;for(i in u){r=u[i];for(n in r)for(a=r[n],o=0,s=a.length;s>o;o++)l=e.call(t,a[o]),l&&(o--,s--)}},getNearObject:function(e){var t,i,n,o,s,r,a,l,u=this._getCoord(e.x),d=this._getCoord(e.y),h=this._objectPoint,c=this._sqCellSize,p=null;for(t=d-1;d+1>=t;t++)if(o=this._grid[t])for(i=u-1;u+1>=i;i++)if(s=o[i])for(n=0,r=s.length;r>n;n++)a=s[n],l=this._sqDist(h[L.Util.stamp(a)],e),c>l&&(c=l,p=a);return p},_getCoord:function(e){return Math.floor(e/this._cellSize)},_sqDist:function(e,t){var i=t.x-e.x,n=t.y-e.y;return i*i+n*n}},function(){L.QuickHull={getDistant:function(e,t){var i=t[1].lat-t[0].lat,n=t[0].lng-t[1].lng;return n*(e.lat-t[0].lat)+i*(e.lng-t[0].lng)},findMostDistantPointFromBaseLine:function(e,t){var i,n,o,s=0,r=null,a=[];for(i=t.length-1;i>=0;i--)n=t[i],o=this.getDistant(n,e),o>0&&(a.push(n),o>s&&(s=o,r=n));return{maxPoint:r,newPoints:a}},buildConvexHull:function(e,t){var i=[],n=this.findMostDistantPointFromBaseLine(e,t);return n.maxPoint?(i=i.concat(this.buildConvexHull([e[0],n.maxPoint],n.newPoints)),i=i.concat(this.buildConvexHull([n.maxPoint,e[1]],n.newPoints))):[e[0]]},getConvexHull:function(e){var t,i=!1,n=!1,o=null,s=null;for(t=e.length-1;t>=0;t--){var r=e[t];(i===!1||r.lat>i)&&(o=r,i=r.lat),(n===!1||r.lat<n)&&(s=r,n=r.lat)}var a=[].concat(this.buildConvexHull([s,o],e),this.buildConvexHull([o,s],e));return a}}}(),L.MarkerCluster.include({getConvexHull:function(){var e,t,i=this.getAllChildMarkers(),n=[];for(t=i.length-1;t>=0;t--)e=i[t].getLatLng(),n.push(e);return L.QuickHull.getConvexHull(n)}}),L.MarkerCluster.include({_2PI:2*Math.PI,_circleFootSeparation:25,_circleStartAngle:Math.PI/6,_spiralFootSeparation:28,_spiralLengthStart:11,_spiralLengthFactor:5,_circleSpiralSwitchover:9,spiderfy:function(){if(this._group._spiderfied!==this&&!this._group._inZoomAnimation){var e,t=this.getAllChildMarkers(),i=this._group,n=i._map,o=n.latLngToLayerPoint(this._latlng);this._group._unspiderfy(),this._group._spiderfied=this,t.length>=this._circleSpiralSwitchover?e=this._generatePointsSpiral(t.length,o):(o.y+=10,e=this._generatePointsCircle(t.length,o)),this._animationSpiderfy(t,e)}},unspiderfy:function(e){this._group._inZoomAnimation||(this._animationUnspiderfy(e),this._group._spiderfied=null)},_generatePointsCircle:function(e,t){var i,n,o=this._group.options.spiderfyDistanceMultiplier*this._circleFootSeparation*(2+e),s=o/this._2PI,r=this._2PI/e,a=[];for(a.length=e,i=e-1;i>=0;i--)n=this._circleStartAngle+i*r,a[i]=new L.Point(t.x+s*Math.cos(n),t.y+s*Math.sin(n))._round();return a},_generatePointsSpiral:function(e,t){var i,n=this._group.options.spiderfyDistanceMultiplier*this._spiralLengthStart,o=this._group.options.spiderfyDistanceMultiplier*this._spiralFootSeparation,s=this._group.options.spiderfyDistanceMultiplier*this._spiralLengthFactor,r=0,a=[];for(a.length=e,i=e-1;i>=0;i--)r+=o/n+5e-4*i,a[i]=new L.Point(t.x+n*Math.cos(r),t.y+n*Math.sin(r))._round(),n+=this._2PI*s/r;return a},_noanimationUnspiderfy:function(){var e,t,i=this._group,n=i._map,o=i._featureGroup,s=this.getAllChildMarkers();for(this.setOpacity(1),t=s.length-1;t>=0;t--)e=s[t],o.removeLayer(e),e._preSpiderfyLatlng&&(e.setLatLng(e._preSpiderfyLatlng),delete e._preSpiderfyLatlng),e.setZIndexOffset&&e.setZIndexOffset(0),e._spiderLeg&&(n.removeLayer(e._spiderLeg),delete e._spiderLeg);i._spiderfied=null}}),L.MarkerCluster.include(L.DomUtil.TRANSITION?{SVG_ANIMATION:function(){return t.createElementNS("http://www.w3.org/2000/svg","animate").toString().indexOf("SVGAnimate")>-1}(),_animationSpiderfy:function(e,i){var n,o,s,r,a=this,l=this._group,u=l._map,d=l._featureGroup,h=u.latLngToLayerPoint(this._latlng);for(n=e.length-1;n>=0;n--)o=e[n],o.setOpacity?(o.setZIndexOffset(1e6),o.setOpacity(0),d.addLayer(o),o._setPos(h)):d.addLayer(o);l._forceLayout(),l._animationStart();var c=L.Path.SVG?0:.3,p=L.Path.SVG_NS;for(n=e.length-1;n>=0;n--)if(r=u.layerPointToLatLng(i[n]),o=e[n],o._preSpiderfyLatlng=o._latlng,o.setLatLng(r),o.setOpacity&&o.setOpacity(1),s=new L.Polyline([a._latlng,r],{weight:1.5,color:"#222",opacity:c}),u.addLayer(s),o._spiderLeg=s,L.Path.SVG&&this.SVG_ANIMATION){var _=s._path.getTotalLength();s._path.setAttribute("stroke-dasharray",_+","+_);var f=t.createElementNS(p,"animate");f.setAttribute("attributeName","stroke-dashoffset"),f.setAttribute("begin","indefinite"),f.setAttribute("from",_),f.setAttribute("to",0),f.setAttribute("dur",.25),s._path.appendChild(f),f.beginElement(),f=t.createElementNS(p,"animate"),f.setAttribute("attributeName","stroke-opacity"),f.setAttribute("attributeName","stroke-opacity"),f.setAttribute("begin","indefinite"),f.setAttribute("from",0),f.setAttribute("to",.5),f.setAttribute("dur",.25),s._path.appendChild(f),f.beginElement()}if(a.setOpacity(.3),L.Path.SVG)for(this._group._forceLayout(),n=e.length-1;n>=0;n--)o=e[n]._spiderLeg,o.options.opacity=.5,o._path.setAttribute("stroke-opacity",.5);setTimeout(function(){l._animationEnd(),l.fire("spiderfied")},200)},_animationUnspiderfy:function(e){var t,i,n,o=this._group,s=o._map,r=o._featureGroup,a=e?s._latLngToNewLayerPoint(this._latlng,e.zoom,e.center):s.latLngToLayerPoint(this._latlng),l=this.getAllChildMarkers(),u=L.Path.SVG&&this.SVG_ANIMATION;for(o._animationStart(),this.setOpacity(1),i=l.length-1;i>=0;i--)t=l[i],t._preSpiderfyLatlng&&(t.setLatLng(t._preSpiderfyLatlng),delete t._preSpiderfyLatlng,t.setOpacity?(t._setPos(a),t.setOpacity(0)):r.removeLayer(t),u&&(n=t._spiderLeg._path.childNodes[0],n.setAttribute("to",n.getAttribute("from")),n.setAttribute("from",0),n.beginElement(),n=t._spiderLeg._path.childNodes[1],n.setAttribute("from",.5),n.setAttribute("to",0),n.setAttribute("stroke-opacity",0),n.beginElement(),t._spiderLeg._path.setAttribute("stroke-opacity",0)));setTimeout(function(){var e=0;for(i=l.length-1;i>=0;i--)t=l[i],t._spiderLeg&&e++;for(i=l.length-1;i>=0;i--)t=l[i],t._spiderLeg&&(t.setOpacity&&(t.setOpacity(1),t.setZIndexOffset(0)),e>1&&r.removeLayer(t),s.removeLayer(t._spiderLeg),delete t._spiderLeg);o._animationEnd()},200)}}:{_animationSpiderfy:function(e,t){var i,n,o,s,r=this._group,a=r._map,l=r._featureGroup;for(i=e.length-1;i>=0;i--)s=a.layerPointToLatLng(t[i]),n=e[i],n._preSpiderfyLatlng=n._latlng,n.setLatLng(s),n.setZIndexOffset&&n.setZIndexOffset(1e6),l.addLayer(n),o=new L.Polyline([this._latlng,s],{weight:1.5,color:"#222"}),a.addLayer(o),n._spiderLeg=o;this.setOpacity(.3),r.fire("spiderfied")},_animationUnspiderfy:function(){this._noanimationUnspiderfy()}}),L.MarkerClusterGroup.include({_spiderfied:null,_spiderfierOnAdd:function(){this._map.on("click",this._unspiderfyWrapper,this),this._map.options.zoomAnimation&&this._map.on("zoomstart",this._unspiderfyZoomStart,this),this._map.on("zoomend",this._noanimationUnspiderfy,this),L.Path.SVG&&!L.Browser.touch&&this._map._initPathRoot()},_spiderfierOnRemove:function(){this._map.off("click",this._unspiderfyWrapper,this),this._map.off("zoomstart",this._unspiderfyZoomStart,this),this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._unspiderfy()},_unspiderfyZoomStart:function(){this._map&&this._map.on("zoomanim",this._unspiderfyZoomAnim,this)},_unspiderfyZoomAnim:function(e){L.DomUtil.hasClass(this._map._mapPane,"leaflet-touching")||(this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._unspiderfy(e))},_unspiderfyWrapper:function(){this._unspiderfy()},_unspiderfy:function(e){this._spiderfied&&this._spiderfied.unspiderfy(e)},_noanimationUnspiderfy:function(){this._spiderfied&&this._spiderfied._noanimationUnspiderfy()},_unspiderfyLayer:function(e){e._spiderLeg&&(this._featureGroup.removeLayer(e),e.setOpacity(1),e.setZIndexOffset(0),this._map.removeLayer(e._spiderLeg),delete e._spiderLeg)}})}(window,document);